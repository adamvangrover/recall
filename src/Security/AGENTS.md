# AGENTS.md: Security & Privacy Hardening (Phase 4)

This document provides a guide for AI agents developing the Security & Privacy Hardening for the Total Recall System.

## 1. Objective
Re-architect the system to meet the non-negotiable security and privacy requirements outlined in the foundational research.

## 2. Key Requirements

### 2.1. Mandatory Opt-In
- The feature must be disabled by default.
- The first-run experience must provide a clear, transparent explanation and require explicit user consent to enable.

### 2.2. Biometric Gating
- Integrate with Windows Hello Enhanced Sign-in Security (ESS).
- Enabling the feature and accessing the Recall UI must require a successful biometric (face/fingerprint) check.

### 2.3. Hardware-Anchored Encryption
- The SQLite database and all snapshots must be encrypted at rest using a robust algorithm (e.g., AES-256).
- The master encryption keys must be generated by and protected within the system's hardware TPM or Microsoft Pluton security processor.
- Implement "Just-in-Time" decryption, protected by the Windows Hello ESS check.

### 2.4. Virtualization-Based Security (VBS)
- The entire Recall service (ingestion, AI processing, data store) must be architecturally isolated from the main OS by running it within a VBS secure enclave.

### 2.5. Granular User Controls
- The UI must provide a dedicated settings area for:
    - Excluding specific applications and websites from capture.
    - Pausing/resuming capture.
    - Viewing and deleting individual snapshots or time ranges.
    - Securely deleting the entire history.
    - Configuring data lifecycle policies (e.g., storage limits, auto-delete after X days).

## 3. Deliverable
A production-hardened system that aligns with the "Privacy and Security by Design" checklist.
